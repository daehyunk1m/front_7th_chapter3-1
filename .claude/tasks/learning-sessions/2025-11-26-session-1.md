# 학습 세션 로그

## 세션 정보
| 항목 | 내용 |
|------|------|
| 날짜 | 2025-11-26 |
| 세션 번호 | 1 |
| 학습 주제 | Badge 컴포넌트 마이그레이션 + Table 3레이어 아키텍처 리팩토링 |
| 진행 상태 | 완료 |

---

## 오늘의 학습 목표
- [x] Badge 컴포넌트 shadcn/ui 마이그레이션 및 CVA 커스터마이징
- [x] Table 컴포넌트 관심사 분리 (3레이어 아키텍처)
- [x] useManagement 커스텀 훅 생성

---

## Q&A 기록

### Q1: Badge 컴포넌트의 비즈니스 로직 문제
**질문**: 레거시 Badge가 `status`, `userRole`, `priority` 등 비즈니스 로직을 내부에 가지고 있는 문제를 어떻게 해결해야 하나?

**답변**: 관심사 분리 원칙 적용
- Badge는 순수 UI 역할만 수행 (variant, size, pill props)
- 비즈니스 로직(status → variant 매핑)은 사용하는 컴포넌트에서 처리
- `roleVariantMap`, `statusVariantMap` 등의 매핑 객체로 명시적 변환

### Q2: 커스텀 훅과 JSX 반환
**질문**: 커스텀 훅에서 JSX를 반환해도 되나?

**답변**:
- 커스텀 훅은 상태와 로직만 반환하는 것이 원칙
- JSX 렌더링이 필요하면 별도 컴포넌트로 분리
- 결론: 3레이어 아키텍처로 해결 (Page → Domain Table → Pure Table)

### Q3: Column render 함수 파라미터
**질문**: render 함수에서 row 데이터에 접근하려면?

**답변**: `render: (value, row) => ReactNode` 형태로 두 번째 파라미터로 전체 row 접근 가능

---

## 학습한 개념

### 1. 3레이어 테이블 아키텍처
```
ManagementPage.tsx (페이지 레이어)
  └─ entityType 분기
       ├─ UserTable.tsx (도메인 레이어)
       │    └─ columns 정의 + Badge/Button render
       │         └─ Table.tsx (순수 UI 레이어)
       └─ PostTable.tsx (도메인 레이어)
            └─ columns 정의 + Badge/Button render
                 └─ Table.tsx (순수 UI 레이어)
```

### 2. Column render 함수 패턴
```tsx
const columns: Column[] = [
  {
    key: "role",
    header: "역할",
    render: (value: string, row: User) => {
      const variantMap = { admin: "danger", user: "primary" };
      return <Badge variant={variantMap[value]}>{value}</Badge>;
    },
  },
];
```

### 3. CVA를 활용한 Badge 커스터마이징
- 6가지 variant (primary, secondary, success, danger, warning, info)
- 3가지 size (small, medium, large)
- pill prop으로 둥근 모서리 지원

### 4. 디자인 토큰 확장
- `--warning`, `--info` 색상 토큰 추가
- TailwindCSS `@theme inline` 블록에 매핑

---

## 주요 코드 변경

### 새로 생성된 파일
| 파일 | 설명 |
|------|------|
| `components/tables/Table.tsx` | 순수 UI Table 컴포넌트 |
| `components/tables/UserTable.tsx` | User 도메인 Table |
| `components/tables/PostTable.tsx` | Post 도메인 Table |
| `components/ui/table.tsx` | shadcn/ui Table primitives |
| `hooks/useManagement.ts` | 관리 페이지 상태 관리 훅 |

### 수정된 파일
| 파일 | 변경 내용 |
|------|------|
| `components/ui/badge.tsx` | CVA 커스터마이징 (6 variants, 3 sizes, pill) |
| `styles/components.css` | warning, info 토큰 추가, global reset에서 span 제외 |
| `pages/ManagementPage.tsx` | entityType 분기로 UserTable/PostTable 렌더링 |

---

## 커밋 로그

| 해시 | 메시지 |
|------|------|
| efe7cf5 | Refactor: Table 컴포넌트 리팩토링, PostTable, UserTable 추가 및 로직 관심사 분리 |
| ec7cb00 | Refactor: Badge 컴포넌트 리팩토링, 폴더구조 리팩토링 문서 작성 |

---

## 해결한 문제들

### 1. Global CSS reset이 Badge 패딩에 영향
- **문제**: `* { padding: 0; }` 가 Badge의 패딩을 제거
- **해결**: `*:not(button):not(span)` 으로 수정

### 2. render 함수에서 row 데이터 접근 불가
- **문제**: `render: () => ...` 로 정의하여 파라미터 누락
- **해결**: `render: (value, row) => ...` 로 수정

### 3. PostTable import 경로 공백
- **문제**: `" PostTable"` 처럼 공백이 포함된 파일명
- **해결**: 파일명 정리 및 import 경로 수정

---

## PR/회고용 노트

### 잘한 점
- 3레이어 아키텍처로 관심사를 명확히 분리
- Column render 함수 패턴으로 유연한 셀 커스터마이징
- 디자인 토큰 시스템을 일관되게 확장

### 개선할 점
- Table 컴포넌트 내부 상태(정렬, 페이지네이션)를 외부로 분리 검토
- TypeScript 제네릭으로 타입 안전성 강화 가능

### 학습 인사이트
- "커스텀 훅은 상태만, 렌더링은 컴포넌트로" 원칙 이해
- render 함수 패턴이 headless UI 라이브러리들이 사용하는 핵심 패턴

---

## 다음 세션 계획

### 우선순위 높음
1. **FormInput 컴포넌트 마이그레이션**
   - shadcn/ui Input 활용
   - validation 로직 분리

2. **FormSelect 컴포넌트 마이그레이션**
   - shadcn/ui Select 활용

### 우선순위 중간
3. **Modal 컴포넌트 마이그레이션**
   - shadcn/ui Dialog 활용
   - Radix UI 접근성 기능 활용

4. **Alert 컴포넌트 마이그레이션**

### 참고사항
- `_legacy` 폴더의 molecules/organisms 컴포넌트들이 아직 사용 중
- 마이그레이션 완료 후 `_legacy` 폴더 제거 예정
